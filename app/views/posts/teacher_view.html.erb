<% provide(:title, "Teacher View") %> 
<div class="row">   
  <div class="post_review_user_info">
    <div class="accorion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseUser">
          <p><strong>Author Information:</strong></p>
        </a>
    </div>
    <div id="collapseUser" class="accordion-body collapse">        
      <div class="accordion-toggle">  
        <%= render partial: 'posts/post_user', locals: {post: @post} %>
      </div>     
    </div>     
    <% if !@post.visible? %>   
      <% if current_user.admin? || current_user.role == "teacher" %>
        <div class="btn-formtastic">
          <%= render partial: 'alarms/unalarm', locals: {post: @post} %>
        </div>
      <% end %>
    <% end %>     
    <%= render partial: 'posts/post_stats', locals: {post: @post} %>
  </div>
</div>
<div class="row border">     
  <div class="span5">
    <%= image_tag(@post.photo.url (:large), alt: "Shooloo Common Core Math Problem ##{@post.id}", title: "Shooloo Common Core Math Problem ##{@post.id}")  %><br/>
    <% unless @post.image_host.nil? %>
      <span class="image-host-large">Image courtesy of <%= @post.image_host %>.
      </span><br/> 
    <% end %>
    <div class="row">
      <% if @post.visible? %>
        <span class='search-label'> 
          <%= render partial: 'alarms/alarm', locals: {post: @post} %>   
        </span>
        <% if current_user?(@post.user) || current_user.admin? %> 
          <%= link_to raw('<i class="icon-trash"></i> Post'), @post, method: :delete,
            data: { confirm: "Delete post. Are you sure? You will lose all of your ratings and comments." },
            title: "Delete Post", class: "btn btn-small btn-default" %>
          <%= render partial: 'shared/rating_show_avg', locals: { local_object: @post } %>
          <%= link_to raw('<i class="icon-pencil icon-white"></i> Post'), edit_post_path(@post), title: "Edit Post", class: "btn btn-small btn-success" %>          
        <% else %>   
          <% if @post.ratings.find_by_rater_id(current_user.id) %>
            <%= link_to raw('<i class="icon-trash"></i> Rating'), @post.ratings.find_by_rater_id(current_user.id), method: :delete, title: "Delete Rating", class: "btn btn-small btn-default", data: { confirm: "Delete rating. Are you sure?" } %> 
            <%= link_to raw('<i class="icon-pencil"></i> Rating'), edit_post_rating_path(@post, @post.rating_by(current_user)), title: "Edit Rating", class: "btn btn-small btn-default" %>
            <%= render partial: 'shared/rating_show_avg', locals: { local_object: @post } %>
          <% else %>
            <%= link_to raw('<i class="icon-star"></i> Rate'), new_post_rating_path(@post), class: "btn btn-small btn-default" %>  
          <% end %>
          <span class='search-label'> 
            <%= render partial: 'likes/like_form', locals: {like: @like, post: @post } %>
          </span>       
        <% end %>
        <%= link_to raw('<i class="icon-comment icon-white"></i> Comment'), new_post_comment_path(@post), class: "btn btn-small btn-success" %> 
      <% end %><br/>
    </div>
  </div>
  
  <div class="span7 normal-font">         
    <p><strong>Question: </strong><%= simple_format(@post.question) %></p>
    <div class="accorion-heading">
    	<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
    		<p><strong>Answer: </strong></p>
    	</a>
    </div>
    <div id="collapseOne" class="accordion-body collapse">    	
  		<div class="accordion-toggle">    				
  			<p><%= @post.answer %><i><span class="no"> - Is this answer correct?</span></i></p>
  		</div>		   		
    </div>
    <% unless @post.level.nil? %>
	    <div class="accorion-heading">
	    	<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
	      		<p><strong>"I can" statement: </strong></p>
	      	</a>
	    </div>
	    <div id="collapseTwo" class="accordion-body collapse">	    	
			  <div class="accordion-toggle">  
    			<p>In <%= @post.domain.name %>, <%= @post.standard.ICan %><i><span class="no"> - Is this "I can" statement suitable for this question?</span></i></p>
    		</div>	   
	    </div>
    <% end %>
  </div>
</div>

<% if !@comments.blank? %>
	<div class="accorion-heading">
    	<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseComments">
			<h3 class="center"> Comments </h3>
		</a>
	</div>
	<div id="collapseComments" class="accordion-body collapse">    
		<div class="accordion-toggle"> 
			<ol class="posts">
			  <% unless @comments.hidden.blank? %>
			  	<div class="accorion-heading">
  					<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseAlarmed">
  						<h4>Alarmed Comments</h4>
  					</a>
  				</div>
				  <div id="collapseAlarmed" class="accordion-body collapse">
			    	<div class="well well-small">
						  <div class="accordion-toggle">    		
			    			<%= render @comments.hidden %>
			    		</div>
			    	</div>
			    </div>
			  <% end %>   		
				<%= render @comments.visible %>
			</ol>
		</div>		
	</div>
<% end %>

<h2> Post A New Comment<a href="#", class="follow", rel="popover", title="How to Make a Winning Comment?", data-content="<ul class='popover-list'><li>Watch this <a href='<%= video_path(5) %>'>video tutorial</a></li><li>Write complete sentenses</li><li>Use correct spelling and grammar</li><li>Explain how you've got your answer</li><li>Use friendly language</li><li>Avoid foul or offensive words</li><li>Do NOT use anyone's real name; use screen name only</li><li>Do NOT tell or ask anyone's personal information</li></ul>"><img src="/attachments/secret_2.gif" alt="Shooloo Math Secret"></i></a></h2>
<%= form_for([@post, @comment], :html => { :multipart => true, onsubmit: "$('input[type=submit]', this).attr('disabled','disabled')"}) do |f| %>
  	<%= render 'shared/error_messages', object: f.object %>
    <%= f.text_area :content, rows: 5 %>
    <div class="right_align">
  		<%= f.submit "Submit Comment", class: "btn btn-large btn-primary" %>
  	</div>
<% end %>


