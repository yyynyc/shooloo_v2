/*
 Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.html or http://ckeditor.com/license
*/
CKEDITOR.dialog.add("checkspell",function(a){function b(a,b){var d=0;return function(){"function"==typeof window.doSpell?("undefined"!=typeof h&&window.clearInterval(h),c(a)):180==d++&&window._cancelOnError(b)}}function c(b){var c=new window._SP_FCK_LangCompare,d=CKEDITOR.getUrl(a.plugins.wsc.path+"dialogs/"),h=d+"tmpFrameset.html";window.gFCKPluginName="wsc",c.setDefaulLangCode(a.config.defaultLanguage),window.doSpell({ctrl:f,lang:a.config.wsc_lang||c.getSPLangCode(a.langCode),intLang:a.config.wsc_uiLang||c.getSPLangCode(a.langCode),winType:e,onCancel:function(){b.hide()},onFinish:function(c){a.focus(),b.getParentEditor().setData(c.value),b.hide()},staticFrame:h,framesetPath:h,iframePath:d+"ciframe.html",schemaURI:d+"wsc.css",userDictionaryName:a.config.wsc_userDictionaryName,customDictionaryName:a.config.wsc_customDictionaryIds&&a.config.wsc_customDictionaryIds.split(","),domainName:a.config.wsc_domainName}),CKEDITOR.document.getById(g).setStyle("display","none"),CKEDITOR.document.getById(e).setStyle("display","block")}var d=CKEDITOR.tools.getNextNumber(),e="cke_frame_"+d,f="cke_data_"+d,g="cke_error_"+d,h,d=document.location.protocol||"http:",i=a.lang.wsc.notAvailable,j='<textarea style="display: none" id="'+f+'" rows="10" cols="40"> </textarea><div id="'+g+'" style="display:none;color:red;font-size:16px;font-weight:bold;padding-top:160px;text-align:center;z-index:11;"></div><iframe src="" style="width:100%;background-color:#f1f1e3;" frameborder="0" name="'+e+'" id="'+e+'" allowtransparency="1"></iframe>',k=a.config.wsc_customLoaderScript||d+"//loader.webspellchecker.net/sproxy_fck/sproxy.php?plugin=fck2&customerid="+a.config.wsc_customerId+"&cmd=script&doc=wsc&schema=22";return a.config.wsc_customLoaderScript&&(i+='<p style="color:#000;font-size:11px;font-weight: normal;text-align:center;padding-top:10px">'+a.lang.wsc.errorLoading.replace(/%s/g,a.config.wsc_customLoaderScript)+"</p>"),window._cancelOnError=function(b){if("undefined"==typeof window.WSC_Error){CKEDITOR.document.getById(e).setStyle("display","none");var c=CKEDITOR.document.getById(g);c.setStyle("display","block"),c.setHtml(b||a.lang.wsc.notAvailable)}},{title:a.config.wsc_dialogTitle||a.lang.wsc.title,minWidth:485,minHeight:380,buttons:[CKEDITOR.dialog.cancelButton],onShow:function(){var c=this.getContentElement("general","content").getElement();c.setHtml(j),c.getChild(2).setStyle("height",this._.contentSize.height+"px"),"function"!=typeof window.doSpell&&CKEDITOR.document.getHead().append(CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript",src:k}})),c=a.getData(),CKEDITOR.document.getById(f).setValue(c),h=window.setInterval(b(this,i),250)},onHide:function(){window.ooo=void 0,window.int_framsetLoaded=void 0,window.framesetLoaded=void 0,window.is_window_opened=!1},contents:[{id:"general",label:a.config.wsc_dialogTitle||a.lang.wsc.title,padding:0,elements:[{type:"html",id:"content",html:""}]}]}}),CKEDITOR.dialog.on("resize",function(a){var a=a.data,b=a.dialog;"checkspell"==b._.name&&((b=(b=b.getContentElement("general","content").getElement())&&b.getChild(2))&&b.setSize("height",a.height),b&&b.setSize("width",a.width))});